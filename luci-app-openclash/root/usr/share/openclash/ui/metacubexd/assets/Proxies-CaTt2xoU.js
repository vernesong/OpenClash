import{u as W,f as e,au as fe,i as n,ai as O,av as xe,aw as be,C as p,ax as pe,ay as $e,az as _e,F as B,aA as ye,aB as we,aC as Ce,aD as Pe,aE as j,_ as f,aF as Se,aG as Te,aH as Le,aI as Ee,aJ as Z,aK as ve,aL as G,aM as X,O as Ne,t as h,aN as Ie,aO as re,S as R,aP as N,aQ as he,aR as ee,a0 as A,$ as K,ag as De,G as se,D as ke,V as Me,b as Oe,x as Ae,Q as Be,y as le,o as Fe,B as Y,aS as ie,a5 as Ue,aT as je,aU as ae,aV as ce,aW as oe,aX as de,k as Re}from"./index-lRj6mBgc.js";import{f as He}from"./global-D4eCvQc9.js";var Ye=h('<div class="flex flex-col gap-4"><div><div class="flex w-full justify-center"><input class=toggle type=checkbox></div></div><div class="flex flex-col"><input class="input input-bordered w-full"></div><div><input type=number class="input input-bordered w-full"></div><div class="flex flex-col"><input class="input input-bordered w-full"></div><div><select class="select select-bordered w-full"></select></div><div><div class="flex w-full justify-center"><input class=toggle type=checkbox></div></div><div><div class="flex w-full justify-center"><input class=toggle type=checkbox></div></div><div><select class="select select-bordered w-full">'),ze=h('<option class="flex items-center gap-2">'),Qe=h("<option>");const Ve=l=>{const[r]=W();return e(Ne,{ref:t=>{var i;return(i=l.ref)==null?void 0:i.call(l,t)},get icon(){return e(fe,{size:24})},get title(){return r("proxiesSettings")},get children(){var t=Ye(),i=t.firstChild,o=i.firstChild,u=o.firstChild,m=i.nextSibling,L=m.firstChild,d=m.nextSibling,I=d.firstChild,x=d.nextSibling,C=x.firstChild,P=x.nextSibling,S=P.firstChild,g=P.nextSibling,_=g.firstChild,D=_.firstChild,T=g.nextSibling,k=T.firstChild,z=k.firstChild,Q=T.nextSibling,U=Q.firstChild;return n(i,e(O,{withDivider:!0,get children(){return r("autoCloseConns")}}),o),u.addEventListener("change",c=>xe(c.target.checked)),n(m,e(O,{withDivider:!0,get children(){return r("urlForLatencyTest")}}),L),L.addEventListener("change",c=>be(c.target.value)),n(d,e(O,{withDivider:!0,get children(){return[p(()=>r("latencyTestTimeoutDuration"))," (",p(()=>r("ms")),")"]}}),I),I.addEventListener("change",c=>pe(Number(c.target.value))),n(x,e(O,{withDivider:!0,get children(){return r("urlForIPv6SupportTest")}}),C),C.addEventListener("change",c=>{var $;return $e(($=c.target.value)==null?void 0:$.trim())}),n(P,e(O,{withDivider:!0,get children(){return r("proxiesSorting")}}),S),S.addEventListener("change",c=>_e(c.target.value)),n(S,e(B,{get each(){return Object.values(ye)},children:c=>(()=>{var $=ze();return $.value=c,n($,()=>r(c)),$})()})),n(g,e(O,{withDivider:!0,get children(){return r("hideUnAvailableProxies")}}),_),D.addEventListener("change",c=>we(c.target.checked)),n(T,e(O,{withDivider:!0,get children(){return r("renderInTwoColumns")}}),k),z.addEventListener("change",c=>Ce(c.target.checked)),n(Q,e(O,{withDivider:!0,get children(){return r("proxiesPreviewType")}}),U),U.addEventListener("change",c=>Pe(c.target.value)),n(U,e(B,{get each(){return Object.values(j)},children:c=>(()=>{var $=Qe();return $.value=c,n($,()=>r(c)),$})()})),f(()=>u.checked=Se()),f(()=>L.value=Te()),f(()=>I.value=Le()),f(()=>C.value=Ee()),f(()=>S.value=Z()),f(()=>D.checked=ve()),f(()=>z.checked=G()),f(()=>U.value=X()),t}})},ue=l=>{const r=()=>X()===j.OFF,t=p(()=>l.proxyNameList.length<=10),i=p(()=>{const u=X();return u===j.BAR||u===j.Auto&&!t()}),o=p(()=>{const u=X();return u===j.DOTS||u===j.Auto&&t()});return e(R,{get when(){return!r()},get children(){return e(Ie,{get children(){return[e(re,{get when(){return i()},get children(){return e(Ke,{get proxyNameList(){return l.proxyNameList},get now(){return l.now}})}}),e(re,{get when(){return o()},get children(){return e(Ze,{get proxyNameList(){return l.proxyNameList},get now(){return l.now}})}})]}})}})};var Xe=h('<div class="flex items-center gap-2 py-2"><div class="my-1 flex flex-1 items-center justify-center overflow-hidden rounded-2xl [&amp;>*]:h-2"><div class=bg-success></div><div class=bg-warning></div><div class=bg-error></div><div class=bg-neutral>');const Ke=l=>{const{getLatencyByName:r}=ee(),t=p(()=>l.proxyNameList.map(d=>r(d))),i=p(()=>t().length),o=p(()=>t().filter(d=>d>N().NOT_CONNECTED&&d<=N().MEDIUM).length),u=p(()=>t().filter(d=>d>N().MEDIUM&&d<=N().HIGH).length),m=p(()=>t().filter(d=>d>N().HIGH).length),L=p(()=>t().filter(d=>d===N().NOT_CONNECTED).length);return(()=>{var d=Xe(),I=d.firstChild,x=I.firstChild,C=x.nextSibling,P=C.nextSibling,S=P.nextSibling;return n(d,e(he,{get name(){return l.now}}),null),f(g=>{var _=`${o()*100/i()}%`,D=`${u()*100/i()}%`,T=`${m()*100/i()}%`,k=`${L()*100/i()}%`;return _!==g.e&&((g.e=_)!=null?x.style.setProperty("width",_):x.style.removeProperty("width")),D!==g.t&&((g.t=D)!=null?C.style.setProperty("width",D):C.style.removeProperty("width")),T!==g.a&&((g.a=T)!=null?P.style.setProperty("width",T):P.style.removeProperty("width")),k!==g.o&&((g.o=k)!=null?S.style.setProperty("width",k):S.style.removeProperty("width")),g},{e:void 0,t:void 0,a:void 0,o:void 0}),d})()};var We=h("<div>"),Je=h('<div class="flex items-center gap-2 py-2"><div class="flex flex-1 flex-wrap items-center gap-1">');const qe=l=>{let r=l.selected?"bg-white border-4 border-success":"bg-success";return typeof l.latency!="number"||l.latency===N().NOT_CONNECTED?r=l.selected?"bg-white border-4 border-neutral":"bg-neutral":l.latency>N().HIGH?r=l.selected?"bg-white border-4 border-error":"bg-error":l.latency>N().MEDIUM&&(r=l.selected?"bg-white border-4 border-warning":"bg-warning"),(()=>{var t=We();return f(i=>{var o=A("h-4 w-4 rounded-full",r),u=l.name;return o!==i.e&&K(t,i.e=o),u!==i.t&&De(t,"title",i.t=u),i},{e:void 0,t:void 0}),t})()},Ze=l=>{const{getLatencyByName:r}=ee();return(()=>{var t=Je(),i=t.firstChild;return n(i,e(B,{get each(){return l.proxyNameList.map(o=>[o,r(o)])},children:([o,u])=>{const m=l.now===o;return e(qe,{name:o,latency:u,selected:m})}})),n(t,e(he,{get name(){return l.now}}),null),t})()};var Ge=h("<progress class=progress max=100>"),et=h('<div class="text-sm text-slate-500"> / <!> ( <!>% )'),tt=h('<div class="text-sm text-slate-500">: ');const nt=l=>{const{Download:r=0,Upload:t=0,Total:i=0,Expire:o=0}=l,u=se(i,{units:"iec"}),m=se(r+t,{units:"iec"}),L=ke.toFinite(((r+t)/i*100).toFixed(2));return{total:u,used:m,percentage:L,expirePrefix:()=>{const[x]=W();return x("expire")},expireStr:()=>{const[x]=W();return o===0?x("noExpire"):Me(o*1e3).format("YYYY-MM-DD")}}},rt=l=>{if(!l.subscriptionInfo)return;const r=nt(l.subscriptionInfo);return[(()=>{var t=Ge();return f(()=>t.value=r.percentage),t})(),(()=>{var t=et(),i=t.firstChild,o=i.nextSibling,u=o.nextSibling,m=u.nextSibling;return m.nextSibling,n(t,()=>`${r.used}`,i),n(t,()=>`${r.total}`,o),n(t,()=>r.percentage,m),t})(),(()=>{var t=tt(),i=t.firstChild;return n(t,()=>r.expirePrefix(),i),n(t,()=>r.expireStr(),null),t})()]};var ge=h("<div>"),st=h('<div class="flex h-full flex-col gap-2"><div class="flex items-center gap-2"><div class="tabs-boxed tabs gap-2 pl-0"></div><div class=ml-auto></div></div><div class="flex-1 overflow-y-auto">'),lt=h('<button><span></span><div class="badge badge-sm">'),it=h('<div class="flex items-center justify-between pr-8"><div class="flex items-center gap-2"><span></span><div class="badge badge-sm">'),at=h('<div class="text-sm text-slate-500"> '),ct=h('<div class="flex items-center justify-between pr-8"><div class="flex items-center gap-2"><span></span><div class="badge badge-sm"></div></div><div class="flex items-center gap-2">'),ot=h('<div class="text-sm text-slate-500"> :: <!> ');const gt=()=>{const l=Oe();if(!Ae())return l("/setup",{replace:!0}),null;let r;const[t]=W(),{fetchProxies:i,proxies:o,selectProxyInGroup:u,proxyProviders:m,updateProviderByProviderName:L,updateAllProvider:d,proxyGroupLatencyTest:I,proxyProviderLatencyTest:x,proxyGroupLatencyTestingMap:C,proxyProviderLatencyTestingMap:P,isAllProviderUpdating:S,updatingMap:g}=ee(),[_,D]=Be(le({}),{name:"collapsedMap",storage:localStorage}),T=(b,y)=>{D(V=>({...V,[b]:y}))};Fe(i);const k=async(b,y)=>{b.stopPropagation(),I(y)},z=(b,y)=>{b.stopPropagation(),x(y)},Q=(b,y)=>{b.stopPropagation(),L(y)},U=async b=>{b.stopPropagation(),d()},[c,$]=le("proxies"),me=()=>[{type:"proxies",name:t("proxies"),count:o().length},{type:"proxyProviders",name:t("proxyProviders"),count:m().length}];return(()=>{var b=st(),y=b.firstChild,V=y.firstChild,te=V.nextSibling,ne=y.nextSibling;return n(V,e(B,{get each(){return me()},children:v=>(()=>{var s=lt(),M=s.firstChild,H=M.nextSibling;return s.$$click=()=>$(v.type),n(M,()=>v.name),n(H,()=>v.count),f(()=>K(s,A(c()===v.type&&"tab-active","tab-sm sm:tab-md tab gap-2 px-2"))),s})()})),n(y,e(R,{get when(){return c()==="proxyProviders"},get children(){return e(Y,{class:"btn btn-circle btn-sm",get disabled(){return S()},onClick:v=>U(v),get icon(){return e(ie,{get class(){return A(S()&&"animate-spin text-success")}})}})}}),te),n(te,e(Y,{class:"btn-circle btn-primary btn-sm",onClick:()=>r==null?void 0:r.showModal(),get icon(){return e(Ue,{})}})),n(ne,e(R,{get when(){return c()==="proxies"},get children(){var v=ge();return n(v,e(B,{get each(){return o()},children:s=>{const M=p(()=>je(ae(s.all??[],Z()),ve())),H=[(()=>{var a=it(),E=a.firstChild,w=E.firstChild,J=w.nextSibling;return n(w,()=>s.name),n(J,()=>{var F;return(F=s.all)==null?void 0:F.length}),n(a,e(Y,{class:"btn-circle btn-sm",get disabled(){return C()[s.name]},onClick:F=>k(F,s.name),get icon(){return e(ce,{get class(){return A(C()[s.name]&&"animate-pulse text-success")}})}}),null),a})(),(()=>{var a=at(),E=a.firstChild;return n(a,()=>s.type,E),n(a,()=>{var w;return((w=s.now)==null?void 0:w.length)>0&&` :: ${s.now}`},null),a})(),e(R,{get when(){return!_()[s.name]},get children(){return e(ue,{get proxyNameList(){return M()},get now(){return s.now}})}})];return e(oe,{get isOpen(){return _()[s.name]},title:H,onCollapse:a=>T(s.name,a),get children(){return e(B,{get each(){return M()},children:a=>e(de,{proxyName:a,get isSelected(){return s.now===a},onClick:()=>void u(s,a)})})}})}})),f(()=>K(v,A("grid grid-cols-1 place-items-start gap-2",G()?"sm:grid-cols-2":"sm:grid-cols-1"))),v}}),null),n(ne,e(R,{get when(){return c()==="proxyProviders"},get children(){var v=ge();return n(v,e(B,{get each(){return m()},children:s=>{const M=p(()=>ae(s.proxies.map(a=>a.name)??[],Z())),H=[(()=>{var a=ct(),E=a.firstChild,w=E.firstChild,J=w.nextSibling,F=E.nextSibling;return n(w,()=>s.name),n(J,()=>s.proxies.length),n(F,e(Y,{class:"btn btn-circle btn-sm",get disabled(){return g()[s.name]},onClick:q=>Q(q,s.name),get icon(){return e(ie,{get class(){return A(g()[s.name]&&"animate-spin text-success")}})}}),null),n(F,e(Y,{class:"btn btn-circle btn-sm",get disabled(){return P()[s.name]},onClick:q=>z(q,s.name),get icon(){return e(ce,{get class(){return A(P()[s.name]&&"animate-pulse text-success")}})}}),null),a})(),e(rt,{get subscriptionInfo(){return s.subscriptionInfo}}),(()=>{var a=ot(),E=a.firstChild,w=E.nextSibling;return w.nextSibling,n(a,()=>s.vehicleType,E),n(a,()=>t("updated"),w),n(a,()=>He(s.updatedAt),null),a})(),e(R,{get when(){return!_()[s.name]},get children(){return e(ue,{get proxyNameList(){return M()}})}})];return e(oe,{get isOpen(){return _()[s.name]},title:H,onCollapse:a=>T(s.name,a),get children(){return e(B,{get each(){return M()},children:a=>e(de,{proxyName:a})})}})}})),f(()=>K(v,A("grid grid-cols-1 place-items-start gap-2",G()?"sm:grid-cols-2":"sm:grid-cols-1"))),v}}),null),n(b,e(Ve,{ref:v=>r=v}),null),b})()};Re(["click"]);export{gt as default};
