import{u as T,a as q,b as z,c as H,v as M,o as N,e as h,d,f as X,i as o,g as G,S as J,B as U,I as K,F as O,t as y,z as b,h as C,s as w,j as Q,k as W,l as E,m as Y,n as Z}from"./index-B2UtOO5P.js";import{D as tt}from"./DocumentTitle-CREjclRv.js";var a=[];for(var x=0;x<256;++x)a.push((x+256).toString(16).slice(1));function et(t,n=0){return(a[t[n+0]]+a[t[n+1]]+a[t[n+2]]+a[t[n+3]]+"-"+a[t[n+4]]+a[t[n+5]]+"-"+a[t[n+6]]+a[t[n+7]]+"-"+a[t[n+8]]+a[t[n+9]]+"-"+a[t[n+10]]+a[t[n+11]]+a[t[n+12]]+a[t[n+13]]+a[t[n+14]]+a[t[n+15]]).toLowerCase()}var g,nt=new Uint8Array(16);function st(){if(!g&&(g=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!g))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return g(nt)}var at=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const R={randomUUID:at};function lt(t,n,$){if(R.randomUUID&&!n&&!t)return R.randomUUID();t=t||{};var i=t.random||(t.rng||st)();return i[6]=i[6]&15|64,i[8]=i[8]&63|128,et(i)}var rt=y("<option>"),it=y('<div class="mx-auto flex max-w-screen-sm flex-col items-center gap-4 py-10"><form class=contents><div class="flex w-full flex-col gap-4"><div class=flex-1><label class=label><span class=label-text></span></label><input name=url type=url class="input input-bordered w-full"placeholder=http(s)://{hostname}:{port} list=defaultEndpoints><datalist id=defaultEndpoints><option value=http://127.0.0.1:9090></option></datalist></div><div class=flex-1><label class=label><span class=label-text></span></label><input name=secret type=password class="input input-bordered w-full"placeholder=secret></div></div></form><div class="grid w-full grid-cols-2 gap-4">'),ot=y('<div class="badge badge-info flex w-full cursor-pointer items-center justify-between gap-4 py-4"><span class=truncate>');const ct=b.object({url:b.string().min(1),secret:b.string()}),pt=()=>{const[t]=T(),n=q(),$=z(),i=s=>{E(s),$("/overview",{replace:!0})},I=async s=>{const e=h().find(l=>l.id===s);e&&await C(e.url,e.secret)&&i(s)},f=async({url:s,secret:e})=>{const l=Z(s);if(!await C(l,e))return;const r=lt(),c=h().slice(),u=c.find(v=>v.url===l);if(!u){w([{id:r,url:l,secret:e},...c]),i(r);return}u.secret=e,u.id=r,w(c),i(r)},L=s=>{const{message:e}=s;Q.error(e)},{form:_}=H({extend:M({schema:ct}),onSubmit:f,onError:L}),D=s=>{W()===s&&E(""),w(h().filter(e=>e.id!==s))};return N(async()=>{var l,r;const s=n.search||window.location.search||((r=(l=n.hash.match(/\?.*$/))==null?void 0:l[0])==null?void 0:r.replace("?",""));if(!s)return;const e=new URLSearchParams(s);e.has("hostname")?await f({url:`${e.get("http")?"http:":e.get("https")?"https:":window.location.protocol}//${e.get("hostname")}${e.get("port")?`:${e.get("port")}`:""}`,secret:e.get("secret")??""}):h().length===0&&await f({url:"http://127.0.0.1:9090",secret:""})}),[d(tt,{get children(){return t("setup")}}),(()=>{var s=it(),e=s.firstChild,l=e.firstChild,r=l.firstChild,c=r.firstChild,u=c.firstChild,v=c.nextSibling,S=v.nextSibling;S.firstChild;var k=r.nextSibling,j=k.firstChild,V=j.firstChild,F=e.nextSibling;return X(_,e,()=>_),o(u,()=>t("endpointURL")),o(S,d(J,{get when(){return window.location.origin!=="http://127.0.0.1:9090"},get children(){var p=rt();return G(()=>p.value=window.location.origin),p}}),null),o(V,()=>t("secret")),o(l,d(U,{type:"submit",class:"btn-primary uppercase",get children(){return t("add")}}),null),o(F,d(O,{get each(){return h()},children:({id:p,url:P})=>(()=>{var m=ot(),A=m.firstChild;return m.$$click=()=>I(p),o(A,P),o(m,d(U,{class:"btn-circle btn-ghost btn-xs text-white",onClick:B=>{B.stopPropagation(),D(p)},get children(){return d(K,{})}}),null),m})()})),s})()]};Y(["click"]);export{pt as default};
