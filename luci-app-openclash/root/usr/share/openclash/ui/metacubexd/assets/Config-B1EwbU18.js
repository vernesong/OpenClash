import{b as z,y as H,u as R,b5 as X,D as Z,d as e,t as d,i as t,ab as C,S as P,b6 as ee,b7 as te,c as J,A as le,f as W,B as T,F as D,r as re,b8 as x,g as N,b9 as ne,ba as ae,bb as se,bc as ie,bd as ce,be as oe,bf as ue,bg as de,bh as Q,bi as ge,bj as he,bk as fe,b4 as ve,m as me,bl as pe,bm as be,bn as O,bo as xe,bp as U,bq as $e,br as _e,bs as Ce,bt as j,bu as B,q as L,Z as M,J as K,z as S,v as Y,k as ke,bv as ye,bw as Se}from"./index-BfxF6Zjo.js";import{D as we}from"./DocumentTitle-qgMGpI7d.js";var De=d("<input type=checkbox>"),Te=d("<input>"),Ne=d("<select>"),Ie=d("<label>"),Pe=d("<option>A"),Fe=d("<option>AAAA"),Ae=d("<option>MX"),Ee=d('<div class="flex flex-col p-4">'),Re=d('<div class="flex flex-col"><form class="flex gap-2 sm:flex-row"><div class="flex items-center gap-2">'),je=d("<div class=py-2>"),Be=d('<div class="grid grid-cols-3 gap-2"><fieldset class=fieldset></fieldset><fieldset class=fieldset></fieldset><fieldset class=fieldset>'),Le=d('<form class="grid grid-cols-3 gap-2 sm:grid-cols-5">'),Me=d('<div class="flex flex-col gap-4"><div class="grid grid-cols-3 gap-2"><fieldset class=fieldset></fieldset><fieldset class=fieldset></fieldset><fieldset class=fieldset></fieldset></div><div class="grid grid-cols-2 gap-4 sm:grid-cols-2">'),F=d("<option>"),Qe=d("<fieldset class=fieldset>"),Ve=d('<div class="flex flex-col gap-2"><div class="flex flex-col"></div><div class="flex flex-col">'),qe=d('<div class="grid grid-cols-1 gap-4 sm:grid-cols-2"><div class="flex flex-col gap-2"><div class="flex flex-col items-center"></div><div class="flex flex-col"></div><div class="flex flex-col"></div></div><div class="flex flex-col gap-2"><div class="flex flex-col items-center">'),Ge=d('<div class="mx-auto flex max-w-screen-md flex-col gap-4">');const E=a=>{const[l,u]=j(a,["class"]);return(()=>{var n=De();return B(n,L({get class(){return M("toggle",l.class)}},u),!1,!1),n})()},A=a=>{const[l,u]=j(a,["class"]);return(()=>{var n=Te();return B(n,L({get class(){return M("input min-w-0",l.class)}},u),!1,!1),n})()},I=a=>{const[l,u]=j(a,["class"]);return(()=>{var n=Ne();return B(n,L({get class(){return M("select",l.class)}},u),!1,!0),t(n,()=>K(()=>u.children)()),n})()},w=a=>{const[l,u]=j(a,["class"]);return(()=>{var n=Ie();return B(n,L({get class(){return M("label truncate",l.class)}},u),!1,!0),t(n,()=>K(()=>u.children)()),n})()},Oe=S.object({name:S.string(),type:S.string()}),Ue=()=>{const[a]=R(),l=te(),u="google.com",{form:n,isSubmitting:k}=J({extend:Y({schema:Oe}),onSubmit:c=>l.get("dns/query",{searchParams:{name:c.name||u,type:c.type}}).json().then(({Answer:m})=>g((m==null?void 0:m.map(({data:r})=>r))||[])).catch(m=>ke.error(m.message))}),[o,g]=le([]);return(()=>{var c=Re(),m=c.firstChild,r=m.firstChild;return W(n,m,()=>n),t(m,e(A,{type:"search",name:"name",class:"flex-1",placeholder:u,onInput:s=>{s.target.value||g([])}}),r),t(r,e(I,{name:"type",get children(){return[Pe(),Fe(),Ae()]}}),null),t(r,e(T,{type:"submit",class:"btn-primary",get loading(){return k()},get children(){return a("dnsQuery")}}),null),t(c,e(P,{get when(){return o().length>0},get children(){var s=Ee();return t(s,e(D,{get each(){return o()},children:p=>(()=>{var y=je();return t(y,p),y})()})),s}}),null),c})()},ze=S.object({port:S.number(),"socks-port":S.number(),"redir-port":S.number(),"tproxy-port":S.number(),"mixed-port":S.number()}),He=({isSingBox:a})=>{const[l]=R(),u=[{label:()=>l("port",{name:"Mixed"}),key:"mixed-port",onChange:r=>void x("mixed-port",Number(r.target.value),c)},{label:()=>l("port",{name:"HTTP"}),key:"port",onChange:r=>void x("port",Number(r.target.value),c)},{label:()=>l("port",{name:"Socks"}),key:"socks-port",onChange:r=>void x("socks-port",Number(r.target.value),c)},{label:()=>l("port",{name:"Redir"}),key:"redir-port",onChange:r=>void x("redir-port",Number(r.target.value),c)},{label:()=>l("port",{name:"TProxy"}),key:"tproxy-port",onChange:r=>void x("tproxy-port",Number(r.target.value),c)}],{form:n,setInitialValues:k,reset:o}=J({extend:Y({schema:ze})}),[g,{refetch:c}]=X(ye);re(()=>{const r=g();r&&(k(r),o())});const m=Z(()=>{const r=g();return(r==null?void 0:r["mode-list"])||(r==null?void 0:r.modes)||["rule","direct","global"]});return(()=>{var r=Me(),s=r.firstChild,p=s.firstChild,y=p.nextSibling,b=y.nextSibling,h=s.nextSibling;return t(p,e(w,{for:"enable-allow-lan",get children(){return l("allowLan")}}),null),t(p,e(E,{id:"enable-allow-lan",get checked(){var i;return(i=g())==null?void 0:i["allow-lan"]},onChange:i=>void x("allow-lan",i.target.checked,c)}),null),t(y,e(w,{for:"mode",get children(){return l("runningMode")}}),null),t(y,e(I,{id:"mode",onChange:i=>void x("mode",i.target.value,c),get children(){return e(D,{get each(){return m()},children:i=>(()=>{var f=F();return f.value=i,t(f,()=>l(i)??i),N(()=>{var $;return f.selected=i===(($=g())==null?void 0:$.mode)}),f})()})}}),null),t(b,e(w,{for:"interface-name",get children(){return l("outboundInterfaceName")}}),null),t(b,e(A,{id:"interface-name",get value(){var i;return(i=g())==null?void 0:i["interface-name"]},onChange:i=>void x("interface-name",i.target.value,c)}),null),t(r,e(P,{get when(){return!a()},get children(){return[(()=>{var i=Be(),f=i.firstChild,$=f.nextSibling,V=$.nextSibling;return t(f,e(w,{for:"enable-tun-device",get children(){return l("enableTunDevice")}}),null),t(f,e(E,{id:"enable-tun-device",get checked(){var v,_;return(_=(v=g())==null?void 0:v.tun)==null?void 0:_.enable},onChange:v=>void x("tun",{enable:v.target.checked},c)}),null),t($,e(w,{for:"tun-ip-stack",get children(){return l("tunModeStack")}}),null),t($,e(I,{id:"tun-ip-stack",onChange:v=>void x("tun",{stack:v.target.value},c),get children(){return e(D,{each:["Mixed","gVisor","System","LWIP"],children:v=>(()=>{var _=F();return _.value=v,t(_,v),N(()=>{var q,G;return _.selected=((G=(q=g())==null?void 0:q.tun)==null?void 0:G.stack)===v}),_})()})}}),null),t(V,e(w,{for:"device-name",get children(){return l("tunDeviceName")}}),null),t(V,e(A,{id:"device-name",get value(){var v,_;return(_=(v=g())==null?void 0:v.tun)==null?void 0:_.device},onChange:v=>void x("tun",{device:v.target.value},c)}),null),i})(),(()=>{var i=Le();return W(n,i,()=>n),t(i,e(D,{each:u,children:f=>(()=>{var $=Qe();return t($,e(w,{get for(){return f.key},get children(){return f.label()}}),null),t($,e(A,{get id(){return f.key},get name(){return f.key},type:"number",get placeholder(){return f.label()},get onChange(){return f.onChange}}),null),$})()})),i})()]}}),h),t(h,e(T,{class:"btn-primary",get loading(){return ae()},onClick:ne,get children(){return l("reloadConfig")}}),null),t(h,e(T,{class:"btn-accent",get loading(){return ie()},onClick:se,get children(){return l("flushFakeIP")}}),null),t(h,e(T,{class:"btn-warning",get loading(){return oe()},onClick:ce,get children(){return l("restartCore")}}),null),t(h,e(P,{get when(){return!a()},get children(){return e(T,{class:"btn-secondary",get loading(){return de()},onClick:ue,get children(){return l("updateGEODatabases")}})}}),null),r})()},Xe=()=>{const[a]=R(),l=z(),u=[{label:()=>a("en"),value:Q.EN},{label:()=>a("zh"),value:Q.ZH},{label:()=>a("ru"),value:Q.RU}];return(()=>{var n=qe(),k=n.firstChild,o=k.firstChild,g=o.nextSibling,c=g.nextSibling,m=k.nextSibling,r=m.firstChild;return t(o,e(C,{get children(){return a("useTwemoji")}}),null),t(o,e(E,{get checked(){return he()},onChange:s=>ge(s.target.checked)}),null),t(g,e(C,{get children(){return a("switchLanguage")}}),null),t(g,e(I,{onChange:s=>fe(s.target.value),get children(){return e(D,{each:u,children:s=>(()=>{var p=F();return t(p,()=>s.label()),N(()=>p.selected=ve()===s.value),N(()=>p.value=s.value),p})()})}}),null),t(c,e(C,{get children(){var s;return(s=H())==null?void 0:s.url}}),null),t(c,e(T,{class:"btn-info",onClick:()=>{me(""),l(pe.Setup)},get children(){return a("switchEndpoint")}}),null),t(r,e(C,{get children(){return a("autoSwitchTheme")}}),null),t(r,e(E,{get checked(){return O()},onChange:s=>be(s.target.checked)}),null),t(m,e(P,{get when(){return O()},get children(){var s=Ve(),p=s.firstChild,y=p.nextSibling;return t(p,e(C,{get children(){return a("favDayTheme")}}),null),t(p,e(I,{onChange:b=>xe(b.target.value),get children(){return e(D,{each:U,children:b=>(()=>{var h=F();return h.value=b,t(h,b),N(()=>h.selected=$e()===b),h})()})}}),null),t(y,e(C,{get children(){return a("favNightTheme")}}),null),t(y,e(I,{onChange:b=>_e(b.target.value),get children(){return e(D,{each:U,children:b=>(()=>{var h=F();return h.value=b,t(h,b),N(()=>h.selected=Ce()===b),h})()})}}),null),s}}),null),n})()},We=()=>{const a=z();if(!H())return a("/setup",{replace:!0}),null;const[l]=R(),u="v1.187.1",[n]=X(Se,{initialValue:""}),k=Z(()=>{var o;return((o=n())==null?void 0:o.includes("sing-box"))||!1});return[e(we,{get children(){return l("config")}}),(()=>{var o=Ge();return t(o,e(P,{get when(){return!k()},get children(){return[e(C,{withDivider:!0,get children(){return l("dnsQuery")}}),e(Ue,{})]}}),null),t(o,e(C,{withDivider:!0,get children(){return l("coreConfig")}}),null),t(o,e(He,{isSingBox:k}),null),t(o,e(C,{withDivider:!0,get children(){return l("xdConfig")}}),null),t(o,e(Xe,{}),null),t(o,e(C,{withDivider:!0,get children(){return l("version")}}),null),t(o,e(P,{get when(){return!n.loading},get children(){return e(ee,{frontendVersion:u,backendVersion:n})}}),null),o})()]};export{We as default};
