import{ao as Oe,ap as Be,aq as he,L as Ae,ar as Re,o as Pe,as as je,A as ie,M as Se,u as ne,d as e,t as m,i as l,aa as D,at as He,au as Fe,D as $,av as ze,aw as We,F as B,ax as Ye,ay as Ve,az as Xe,aA as Ke,aB as X,aC as Qe,aD as Je,g as y,aE as qe,aF as Ze,aG as Ge,aH as ae,aI as Te,aJ as Le,aK as te,aL as re,aM as ce,aN as et,P as tt,aO as rt,aP as me,S as P,aQ as de,aR as M,aS as Ne,Y as K,X as Ue,a8 as Ee,E as oe,J as nt,V as lt,aT as st,H as it,b as at,y as ct,Q as ot,R as dt,B as q,$ as ut,aU as gt,aV as fe,aW as be,aX as vt,aY as xe,n as ht}from"./index-BklDWftz.js";import{D as mt}from"./DocumentTitle-my5Dni1j.js";import{f as ft}from"./time-yVWJ-azh.js";import{I as pe}from"./IconReload-BiOu1XEr.js";function ye(n){const r={...n},s={...n},i={},d=c=>{let h=i[c];if(!h){if(!je())return r[c];i[c]=h=ie(r[c],{internal:!0}),delete r[c]}return h[0]()};for(const c in n)Object.defineProperty(s,c,{get:()=>d(c),enumerable:!0});const a=(c,h)=>{const o=i[c];if(o)return o[1](h);c in r&&(r[c]=he(h,r[c]))};return[s,(c,h)=>{if(Oe(c)){const o=Be(()=>Object.entries(he(c,s)));Ae(()=>{for(const[S,x]of o)a(S,()=>x)})}else a(c,h);return s}]}function bt(n,r){if(Re.context){const[s,i]=ye(n);return Pe(()=>i(r())),[s,i]}return ye(r())}/**
 * @license @tabler/icons-solidjs v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var $e=Se("outline","brand-speedtest","IconBrandSpeedtest",[["path",{d:"M5.636 19.364a9 9 0 1 1 12.728 0"}],["path",{d:"M16 9l-4 4"}]]);/**
 * @license @tabler/icons-solidjs v3.31.0 - MIT
 *
 * This source code is licensed under the MIT license.
 * See the LICENSE file in the root directory of this source tree.
 */var xt=Se("outline","chevron-right","IconChevronRight",[["path",{d:"M9 6l6 6l-6 6"}]]),pt=m('<div class="flex flex-col gap-4"><div><div class="flex w-full justify-center"><input class=toggle type=checkbox></div></div><div class="flex flex-col"><input class=input></div><div><input type=number class=input></div><div><select class=select></select></div><div><div class="flex w-full justify-center"><input class=toggle type=checkbox></div></div><div><div class="flex w-full justify-center"><input class=toggle type=checkbox></div></div><div><select class=select></select></div><div><input type=number class=input><input type=number class=input>'),yt=m('<option class="flex items-center gap-2">'),$t=m("<option>");const wt=n=>{const[r]=ne();return e(tt,{ref:s=>{var i;return(i=n.ref)==null?void 0:i.call(n,s)},get icon(){return e(et,{size:24})},get title(){return r("proxiesSettings")},get children(){var s=pt(),i=s.firstChild,d=i.firstChild,a=d.firstChild,c=i.nextSibling,h=c.firstChild,o=c.nextSibling,S=o.firstChild,x=o.nextSibling,w=x.firstChild,T=x.nextSibling,k=T.firstChild,p=k.firstChild,L=T.nextSibling,O=L.firstChild,_=O.firstChild,E=L.nextSibling,A=E.firstChild,Q=E.nextSibling,z=Q.firstChild,J=z.nextSibling;return l(i,e(D,{withDivider:!0,get children(){return r("autoCloseConns")}}),d),a.addEventListener("change",g=>He(g.target.checked)),l(c,e(D,{withDivider:!0,get children(){return r("urlForLatencyTest")}}),h),h.addEventListener("change",g=>Fe(g.target.value)),l(o,e(D,{withDivider:!0,get children(){return[$(()=>r("latencyTestTimeoutDuration"))," (",$(()=>r("ms")),")"]}}),S),S.addEventListener("change",g=>ze(Number(g.target.value))),l(x,e(D,{withDivider:!0,get children(){return r("proxiesSorting")}}),w),w.addEventListener("change",g=>We(g.target.value)),l(w,e(B,{get each(){return Object.values(Ye)},children:g=>(()=>{var I=yt();return I.value=g,l(I,()=>r(g)),I})()})),l(T,e(D,{withDivider:!0,get children(){return r("hideUnavailableProxies")}}),k),p.addEventListener("change",g=>Ve(g.target.checked)),l(L,e(D,{withDivider:!0,get children(){return r("renderInTwoColumns")}}),O),_.addEventListener("change",g=>Xe(g.target.checked)),l(E,e(D,{withDivider:!0,get children(){return r("proxiesPreviewType")}}),A),A.addEventListener("change",g=>Ke(g.target.value)),l(A,e(B,{get each(){return Object.values(X)},children:g=>(()=>{var I=$t();return I.value=g,l(I,()=>r(g)),I})()})),l(Q,e(D,{withDivider:!0,get children(){return r("iconHeight")}}),z),z.addEventListener("change",g=>Qe(Number(g.target.value))),l(Q,e(D,{withDivider:!0,get children(){return r("iconMarginRight")}}),J),J.addEventListener("change",g=>Je(Number(g.target.value))),y(()=>a.checked=qe()),y(()=>h.value=Ze()),y(()=>S.value=Ge()),y(()=>w.value=ae()),y(()=>p.checked=Te()),y(()=>_.checked=Le()),y(()=>A.value=te()),y(()=>z.value=re()),y(()=>J.value=ce()),s}})},we=n=>{const r=()=>te()===X.OFF,s=$(()=>n.proxyNameList.length<=10),i=$(()=>{const a=te();return a===X.BAR||a===X.Auto&&!s()}),d=$(()=>{const a=te();return a===X.DOTS||a===X.Auto&&s()});return e(P,{get when(){return!r()},get children(){return e(rt,{get children(){return[e(me,{get when(){return i()},get children(){return e(Ct,{get proxyNameList(){return n.proxyNameList},get testUrl(){return n.testUrl},get now(){return n.now}})}}),e(me,{get when(){return d()},get children(){return e(Lt,{get proxyNameList(){return n.proxyNameList},get testUrl(){return n.testUrl},get now(){return n.now}})}})]}})}})};var _t=m('<div class="flex items-center gap-2"><div class="my-1 flex flex-1 items-center justify-center overflow-hidden rounded-2xl [&amp;>*]:h-2"><div class=bg-green-600></div><div class=bg-yellow-500></div><div class=bg-red-500></div><div class=bg-neutral>');const Ct=n=>{const{getLatencyByName:r}=de(),s=$(()=>n.proxyNameList.map(o=>r(o,n.testUrl))),i=$(()=>s().length),d=$(()=>s().filter(o=>o>M().NOT_CONNECTED&&o<=M().MEDIUM).length),a=$(()=>s().filter(o=>o>M().MEDIUM&&o<=M().HIGH).length),c=$(()=>s().filter(o=>o>M().HIGH).length),h=$(()=>s().filter(o=>o===M().NOT_CONNECTED).length);return(()=>{var o=_t(),S=o.firstChild,x=S.firstChild,w=x.nextSibling,T=w.nextSibling,k=T.nextSibling;return l(o,e(P,{get when(){return n.now},get children(){return e(Ne,{get proxyName(){return n.now},get testUrl(){return n.testUrl}})}}),null),y(p=>{var L=`${d()*100/i()}%`,O=`${a()*100/i()}%`,_=`${c()*100/i()}%`,E=`${h()*100/i()}%`;return L!==p.e&&((p.e=L)!=null?x.style.setProperty("width",L):x.style.removeProperty("width")),O!==p.t&&((p.t=O)!=null?w.style.setProperty("width",O):w.style.removeProperty("width")),_!==p.a&&((p.a=_)!=null?T.style.setProperty("width",_):T.style.removeProperty("width")),E!==p.o&&((p.o=E)!=null?k.style.setProperty("width",E):k.style.removeProperty("width")),p},{e:void 0,t:void 0,a:void 0,o:void 0}),o})()};var Pt=m("<div>"),St=m('<div class="flex items-center gap-2"><div class="flex flex-1 flex-wrap items-center gap-1">');const Tt=n=>{let r=n.selected?"bg-white border-4 border-green-600":"bg-green-600";return typeof n.latency!="number"||n.latency===M().NOT_CONNECTED?r=n.selected?"bg-white border-4 border-neutral":"bg-neutral":n.latency>M().HIGH?r=n.selected?"bg-white border-4 border-red-500":"bg-red-500":n.latency>M().MEDIUM&&(r=n.selected?"bg-white border-4 border-yellow-500":"bg-yellow-500"),(()=>{var s=Pt();return y(i=>{var d=K("h-4 w-4 rounded-full",r),a=n.name;return d!==i.e&&Ue(s,i.e=d),a!==i.t&&Ee(s,"title",i.t=a),i},{e:void 0,t:void 0}),s})()},Lt=n=>{const{getLatencyByName:r}=de();return(()=>{var s=St(),i=s.firstChild;return l(i,e(B,{get each(){return n.proxyNameList.map(d=>[d,r(d,n.testUrl)])},children:([d,a])=>e(Tt,{name:d,latency:a,get selected(){return n.now===d}})})),l(s,e(P,{get when(){return n.now},get children(){return e(Ne,{get proxyName(){return n.now},get testUrl(){return n.testUrl}})}}),null),s})()};var Nt=m('<div class="flex items-center gap-2 pt-1"><progress class=progress max=100></progress><div class="badge badge-sm badge-secondary">%'),Ut=m('<div class="flex flex-wrap items-center justify-between"><div class="text-sm text-slate-500"> / </div><div class="text-sm text-slate-500">: ');const Et=n=>{const{Download:r=0,Upload:s=0,Total:i=0,Expire:d=0}=n,a=oe(i,{units:"iec"}),c=oe(r+s,{units:"iec"}),h=Math.min(nt.toFinite(((r+s)/i*100).toFixed(1)),999);return{total:a,used:c,percentage:h,expirePrefix:()=>{const[x]=ne();return x("expire")},expireStr:()=>{const[x]=ne();return d===0?x("noExpire"):lt(d*1e3).format("YYYY-MM-DD")}}},It=n=>{if(!n.subscriptionInfo)return;const r=Et(n.subscriptionInfo);return[(()=>{var s=Nt(),i=s.firstChild,d=i.nextSibling,a=d.firstChild;return l(d,()=>r.percentage,a),y(()=>i.value=r.percentage),s})(),(()=>{var s=Ut(),i=s.firstChild,d=i.firstChild,a=i.nextSibling,c=a.firstChild;return l(i,()=>`${r.used}`,d),l(i,()=>`${r.total}`,null),l(a,()=>r.expirePrefix(),c),l(a,()=>r.expireStr(),null),s})()]},Dt={width:0,height:0};function _e(){return{width:window.innerWidth,height:window.innerHeight}}function Mt(){const[n,r]=bt(Dt,_e);return st(window,"resize",()=>r(_e())),n}var kt=m("<div class=mb-2>"),Ot=m('<div class="flex gap-2"><div class=flex-1></div><div class=flex-1>'),Bt=m('<div class="grid grid-cols-1 place-items-start gap-2">');const Ce=n=>{const r=Mt(),s=$(()=>r.width>480);return()=>{const i=it(()=>n.children),d=a=>{var c;return(c=i())==null?void 0:c.filter((h,o)=>o%2===a).map(h=>(()=>{var o=kt();return l(o,h),o})())};return Le()&&s()?(()=>{var a=Ot(),c=a.firstChild,h=c.nextSibling;return l(c,()=>d(0)),l(h,()=>d(1)),a})():(()=>{var a=Bt();return l(a,i),a})()}};var At=m('<div class="flex h-full flex-col gap-2"><div class="flex items-center gap-2"><div class="tabs tabs-sm gap-2 tabs-box"></div><div class=ml-auto></div></div><div class="flex-1 overflow-y-auto">'),Rt=m('<button><span></span><div class="badge badge-sm">'),jt=m("<div>"),Ht=m("<span class=whitespace-nowrap>"),Ft=m('<div class=space-y-2><div class="flex items-center justify-between pr-8"><div class="flex items-center"><span></span><div class="ml-2 badge badge-sm"></div></div></div><div class="flex flex-wrap items-center justify-between gap-2"><div class="badge badge-sm badge-primary"><span class=font-bold></span></div><div class="badge badge-sm badge-secondary">/s'),zt=m("<img>"),Wt=m('<div class="flex items-center justify-between pr-8"><div class="flex flex-wrap items-center gap-1"><span class="line-clamp-1 break-all"></span><div class="badge badge-sm"></div><div class="badge badge-sm"></div></div><div class="flex items-center gap-2">'),Yt=m('<div class="flex flex-col gap-2"><div class="text-sm text-slate-500"> ');const Jt=()=>{const n=at();if(!ct())return n("/setup",{replace:!0}),null;let r;const[s]=ne(),{fetchProxies:i,proxies:d,selectProxyInGroup:a,proxyProviders:c,updateProviderByProviderName:h,updateAllProvider:o,proxyGroupLatencyTest:S,proxyProviderLatencyTest:x,proxyGroupLatencyTestingMap:w,proxyProviderLatencyTestingMap:T,isAllProviderUpdating:k,updatingMap:p}=de(),L=$(()=>d().filter(f=>!f.hidden)),{speedGroupByName:O}=ot(),[_,E]=dt(ie({}),{name:"collapsedMap",storage:localStorage}),A=(f,C)=>{E(G=>({...G,[f]:C}))};Pe(i);const Q=async(f,C)=>{f.stopPropagation(),S(C)},z=f=>f.replace("<svg",~f.indexOf("xmlns")?"<svg":'<svg xmlns="http://www.w3.org/2000/svg"').replace(/"/g,"'").replace(/%/g,"%25").replace(/#/g,"%23").replace(/\{/g,"%7B").replace(/\}/g,"%7D").replace(/</g,"%3C").replace(/>/g,"%3E"),J=(f,C)=>{f.stopPropagation(),x(C)},g=(f,C)=>{f.stopPropagation(),h(C)},I=async f=>{f.stopPropagation(),o()},[Z,Ie]=ie("proxies"),De=()=>[{type:"proxies",name:s("proxies"),count:L().length},{type:"proxyProviders",name:s("proxyProviders"),count:c().length}];return[e(mt,{get children(){return s("proxies")}}),(()=>{var f=At(),C=f.firstChild,G=C.firstChild,ue=G.nextSibling,ge=C.nextSibling;return l(G,e(B,{get each(){return De()},children:t=>(()=>{var N=Rt(),W=N.firstChild,v=W.nextSibling;return N.$$click=()=>Ie(t.type),l(W,()=>t.name),l(v,()=>t.count),y(()=>Ue(N,K(Z()===t.type&&"bg-primary !text-neutral","sm:tab-md tab gap-2 px-2"))),N})()})),l(C,e(P,{get when(){return Z()==="proxyProviders"},get children(){return e(q,{class:"btn btn-circle btn-sm",get disabled(){return k()},onClick:t=>I(t),get icon(){return e(pe,{get class(){return K(k()&&"animate-spin text-success")}})}})}}),ue),l(ue,e(q,{class:"btn-circle btn-sm btn-primary",onClick:()=>r==null?void 0:r.showModal(),get icon(){return e(ut,{})}})),l(ge,e(P,{get when(){return Z()==="proxies"},get children(){return e(Ce,{get children(){return e(B,{get each(){return L()},children:t=>{const N=$(()=>vt({proxyNames:xe({proxyNames:t.all??[],orderingType:ae(),testUrl:t.testUrl||null}),enabled:Te(),testUrl:t.testUrl||null})),W=(()=>{var v=Ft(),U=v.firstChild,R=U.firstChild,Y=R.firstChild,le=Y.nextSibling,ee=U.nextSibling,j=ee.firstChild,Me=j.firstChild,ve=j.nextSibling,ke=ve.firstChild;return l(R,e(P,{get when(){return t.icon},get children(){return e(P,{get when(){return t.icon.startsWith("data:image/svg+xml")},get fallback(){return(()=>{var u=zt();return y(b=>{var V=t.icon,H=`${re()}px`,F=`${ce()}px`;return V!==b.e&&Ee(u,"src",b.e=V),H!==b.t&&((b.t=H)!=null?u.style.setProperty("height",H):u.style.removeProperty("height")),F!==b.a&&((b.a=F)!=null?u.style.setProperty("margin-right",F):u.style.removeProperty("margin-right")),b},{e:void 0,t:void 0,a:void 0}),u})()},get children(){var u=jt();return u.style.setProperty("color","oklch(var(--p) / var(--tw-bg-opacity))"),u.style.setProperty("background-color","currentColor"),u.style.setProperty("mask-size","100% 100%"),y(b=>{var V=`${re()}px`,H=`${re()}px`,F=`${ce()}px`,se=`url("${z(t.icon)}")`;return V!==b.e&&((b.e=V)!=null?u.style.setProperty("height",V):u.style.removeProperty("height")),H!==b.t&&((b.t=H)!=null?u.style.setProperty("width",H):u.style.removeProperty("width")),F!==b.a&&((b.a=F)!=null?u.style.setProperty("margin-right",F):u.style.removeProperty("margin-right")),se!==b.o&&((b.o=se)!=null?u.style.setProperty("mask-image",se):u.style.removeProperty("mask-image")),b},{e:void 0,t:void 0,a:void 0,o:void 0}),u}})}}),Y),l(Y,()=>t.name),l(le,()=>{var u;return(u=t.all)==null?void 0:u.length}),l(U,e(q,{class:"btn-circle btn-sm",get disabled(){return w()[t.name]},onClick:u=>Q(u,t.name),get icon(){return e($e,{get class(){return K(w()[t.name]&&"animate-pulse text-success")}})}}),null),l(Me,()=>gt(t.type)),l(j,e(P,{get when(){var u;return((u=t.now)==null?void 0:u.length)>0},get children(){return[e(xt,{size:18}),(()=>{var u=Ht();return l(u,()=>t.now),u})()]}}),null),l(ve,()=>oe(O()[t.name]??0).toString(),ke),l(v,e(P,{get when(){return!_()[t.name]},get children(){return e(we,{get proxyNameList(){return N()},get now(){return t.now},get testUrl(){return t.testUrl||null}})}}),null),v})();return e(fe,{get isOpen(){return _()[t.name]},title:W,onCollapse:v=>A(t.name,v),get children(){return e(B,{get each(){return N()},children:v=>e(be,{proxyName:v,get testUrl(){return t.testUrl||null},get timeout(){return t.timeout??null},get isSelected(){return t.now===v},onClick:()=>void a(t,v)})})}})}})}})}}),null),l(ge,e(P,{get when(){return Z()==="proxyProviders"},get children(){return e(Ce,{get children(){return e(B,{get each(){return c()},children:t=>{const N=$(()=>xe({orderingType:ae(),proxyNames:t.proxies.map(v=>v.name)??[],testUrl:t.testUrl})),W=[(()=>{var v=Wt(),U=v.firstChild,R=U.firstChild,Y=R.nextSibling,le=Y.nextSibling,ee=U.nextSibling;return l(R,()=>t.name),l(Y,()=>t.proxies.length),l(le,()=>t.vehicleType),l(ee,e(q,{class:"btn btn-circle btn-sm",get disabled(){return p()[t.name]},onClick:j=>g(j,t.name),get icon(){return e(pe,{get class(){return K(p()[t.name]&&"animate-spin text-success")}})}}),null),l(ee,e(q,{class:"btn btn-circle btn-sm",get disabled(){return T()[t.name]},onClick:j=>J(j,t.name),get icon(){return e($e,{get class(){return K(T()[t.name]&&"animate-pulse text-success")}})}}),null),v})(),e(It,{get subscriptionInfo(){return t.subscriptionInfo}}),(()=>{var v=Yt(),U=v.firstChild,R=U.firstChild;return l(U,()=>s("updated"),R),l(U,()=>ft(t.updatedAt),null),l(v,e(P,{get when(){return!_()[t.name]},get children(){return e(we,{get proxyNameList(){return N()},get testUrl(){return t.testUrl}})}}),null),v})()];return e(fe,{get isOpen(){return _()[t.name]},title:W,onCollapse:v=>A(t.name,v),get children(){return e(B,{get each(){return N()},children:v=>e(be,{proxyName:v,get testUrl(){return t.testUrl},get timeout(){return t.timeout??null}})})}})}})}})}}),null),l(f,e(wt,{ref:t=>r=t}),null),f})()]};ht(["click"]);export{Jt as default};
